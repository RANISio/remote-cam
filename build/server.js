module.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=13)}([function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("ws")},function(e,t){e.exports=require("styled-components")},function(e,t){e.exports=require("uuid")},function(e,t){e.exports=require("babel-runtime/core-js/json/stringify")},function(e,t){e.exports=require("babel-runtime/core-js/object/keys")},function(e,t){e.exports=require("express-session")},function(e,t){e.exports=require("html-minifier")},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("http")},function(e,t,n){"use strict";n.r(t);var o=n(10),r=n.n(o),i=n(9),s=n.n(i),c=n(8),u=n(1),a=n.n(u),l=n(0),f=n.n(l),d=n(7),p=n.n(d)()({saveUninitialized:!1,secret:"$eCuRiTy",resave:!1}),m={},v=n(6),y=n.n(v),h=n(5),b=n.n(h),g=function(e){var t=new Date;console.log("["+t.toLocaleTimeString()+"] Server sais: "+e)},x=n(4),j=n.n(x),S=n(3),q=n(12),w=q.client.css,T=q.client.js;w&&(w=w.replace("/","")),T=T.replace("/","");var O=a()().disable("x-powered-by").use(s()()).use(a.a.static("public")).use(f.a.json()).use(f.a.urlencoded({extended:!0})).use(p).post("/",function(e,t){g("Receied request to join with the following parameters: "+b()(e.body));var n=e.body,o=n.roomName,r=n.role,i=m[o];if(o&&r){if(i)return 2===y()(i).length?(g("Received request to join full room"),void t.status(412).send("This room is full")):i[0].role===r?(g("Received request to join room with conflicting role"),void t.status(409).send("The role in the room already exists")):(g("Joining room: "+o),void t.status(201).send("Success!"));var s=j.a.v4();return e.session.userId=s,e.session.room=o,e.session.role=r,g("Creating room: "+o),void t.status(200).send("Success!")}return g("Bad request received with incomplete paramters."),void t.status(400).send("Parameters are not provided")}).get("/",function(e,t){var n=(new S.ServerStyleSheet).getStyleTags();t.send(Object(c.minify)('<!DOCTYPE HTML>\n\t\t\t<html lang="en">\n\t\t\t\t<head>\n\t\t\t\t\t<title>Remote Camera</title>\n\n\t\t\t\t\t<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">\n\t\t\t\t\t<meta http-equiv="X-UA-Compatible" content="IE=edge">\n\t\t\t\t\t<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\n\n\t\t\t\t\t<meta name="description" content="">\n\n\t\t\t\t\t<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500|Material+Icons">\n\n\t\t\t\t\t'+(w?'<link rel="stylesheet" href="'+w+'">':"")+n+'\n\t\t\t\t\t<script defer type="application/javascript" src="'+T+'"><\/script>\n\t\t\t\t</head>\n\t\t\t\t<body>\n\t\t\t\t\t<div id="root"></div>\n\t\t\t\t</body>\n\t\t\t</html>',{collapseWhitespace:!0,removeComments:!0,minifyCSS:!0,minifyJS:!0}))}),C=n(2),M=n.n(C),P=r.a.createServer(O);!function(e){var t=new M.a.Server({server:e,clientTracking:!0});function n(){this.isAlive=!0}t.on("connection",function(e,o){g("New client connected."),e.isAlive=!0,e.on("pong",n),setInterval(function(){t.clients.forEach(function(e){if(!1===e.isAlive)return delete m[e.room],e.terminate();e.isAlive=!1,e.ping(function(){})})},3e4),p(o,{},function(){var t=e.room=o.session.room;e.role=o.session.role,m[t]||(m[t]=[]),m[t].push(e)}),e.on("message",function(t){g("Received Message from "+e.id+":"+t.type),m[e.room]&&m[e.room].forEach(function(n){n.send&&n!==e&&n.send(t)})}),e.on("close",function(){delete m[e.room]})})}(P);P.listen("3000","localhost",function(e){e&&console.log(e),console.log("Server started at 127.0.0.1:3000.\n")})},function(e){e.exports={client:{js:"/static/js/bundle.7cb48f24.js"}}},function(e,t,n){e.exports=n(11)}]);